language: php

services:
  - mysql

sudo: false

php:
  - 5.6
  - 7.0
  - 7.1

before_script:
  - composer require satooshi/php-coveralls:dev-master -n
  - composer install -n
  - mysql -e 'CREATE DATABASE IF NOT EXISTS magento;'
  - vendor/bin/phinx migrate

script:
  - sh ./run_tests.sh

after_script:
  - php vendor/bin/coveralls -v

notifications:
  webhooks:
    urls:
      secure: "EZl5eDSCyZOqg9WBpuCRFV2CWa6/1dUAFn3+NuneVXpq+oBnbhQLof5af8QCgFng1pFRQVcTQjk2aRm5R+30BOOEDX2AwTScFAUCqYVPgbtolFFndU1gReE3/o0nwTJ/BTodj/wX0akyuauZ5UsVxj5SnqtTFlAMum48dajY26YAA49Mg9KXD2ZDBmNUhjyeZ5RTKLQGVTfmHm9aSNs4l9NIPdo2swtt8m5AyH8+FkkfXOHSt6s3CpngbVMgPdUDlPfESrARACZquyezyWSPHh1UTsYrXDqEcO+FtTdv8fj5UiwLS57IPBfJRkL/6IPUPQ+FGnetwHrQJ4SUd3a86VKmYlxN9WpzUAHtNksa+fBv11XlLAUZ3bkZA0M3MPp9oLq4TdkdDZgjZBKe73GIqEljFfq+SDlyQETxUQ00JLerH6j96vSr4s8cwZEsoG+MAlgI0Ujcf8/x17l3zf5GWX0sQc+Qm2jPdEpDO1onJsvDFxZjLRcf2GMWlC0jobBW/4WlDBBDczOctBDaoxe3Ri4qHMBUr7KhnHUgcmGTKGFWGyl3t14MXeRldXfuUFw7az17HU7+hDWB7SWp++SHBLzRtToGDqwF5N9hXO2OEqwG4W+iXUxEs1m1yAjHJf6VCS1T+tCXEFKv2eHwJFExk7/DEBMeZLOOcoFg4Ez8TvY="
  on_success: always
  on_failure: always
  on_start: change
  on_cancel: always
  on_error: always
